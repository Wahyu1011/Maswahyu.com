<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Penerus Link</title>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
      import {
        getDatabase,
        ref,
        onValue,
      } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

      // TODO: ganti config ini dengan punyamu
      const firebaseConfig = {
        apiKey: "AIzaSyAOiSUjiVWKakL7WbahmvQQp82J6GQ8DSg",
        authDomain: "link-forward-d1a72.firebaseapp.com",
        databaseURL: "https://link-forward-d1a72-default-rtdb.firebaseio.com",
        projectId: "link-forward-d1a72",
        storageBucket: "link-forward-d1a72.firebasestorage.app",
        messagingSenderId: "717414867502",
        appId: "1:717414867502:web:8098377107fd0ee470f5bf",
        measurementId: "G-KWZ6Y2T0SB",
      };

      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);

      window.onload = () => {
        const btn = document.getElementById("visitBtn");
        const linkInfo = document.getElementById("currentLink");

        const linkRef = ref(db, "ngrokLink");
        onValue(linkRef, (snapshot) => {
          const data = snapshot.val();
          if (data && data.url) {
            linkInfo.textContent = "🔗 Link terbaru: " + data.url;
            btn.onclick = () => (window.location.href = data.url);
          } else {
            linkInfo.textContent = "⚠️ Belum ada link tersimpan.";
            btn.onclick = () => alert("⚠️ Belum ada link tersimpan.");
          }
        });
      };
    </script>
  </head>
  <body>
    <h2>Penerus Link</h2>
    <button id="visitBtn">Visit site</button>
    <div id="currentLink"></div>
  </body>
</html>
